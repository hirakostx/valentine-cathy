<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Valentine üíò</title>
  <style>
    :root{
      --bg1:#ff5f8a;
      --bg2:#ff9ac1;
      --yes:#ff2e63;
      --no:#333;
      --card:rgba(255,255,255,.14);
      --shadow:rgba(0,0,0,.28);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: "Comic Sans MS", cursive;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow:hidden;
      user-select:none;
    }
    .wrap{
      width:min(740px, 92vw);
      text-align:center;
      padding:18px;
      animation: popIn .8s ease;
    }
    h1{
      margin:0 0 12px;
      color:#fff;
      font-size:clamp(2rem, 4vw, 3.1rem);
      text-shadow: 0 12px 30px rgba(0,0,0,.25);
      animation: pulse 2s infinite;
    }
    .sub{
      color:rgba(255,255,255,.92);
      margin-top:4px;
      font-size:1rem;
      opacity:.95;
    }
    .card{
      background: var(--card);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 26px;
      padding: 16px;
      box-shadow: 0 18px 40px var(--shadow);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .imgBox{
      display:flex;
      justify-content:center;
      margin: 10px 0 6px;
    }
    img{
      width:min(340px, 82vw);
      border-radius: 22px;
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      animation: float 3s ease-in-out infinite;
      background: rgba(255,255,255,.08);
    }
    .row{
      margin-top: 12px;
      position: relative;
      height: 90px; /* zone pour que le bouton NON bouge */
    }
    .btn{
      border:none;
      border-radius:999px;
      padding:14px 26px;
      font-size:1.15rem;
      cursor:pointer;
      box-shadow: 0 12px 28px rgba(0,0,0,.25);
      transition: transform .15s ease, filter .15s ease;
      position:absolute;
      top: 18px;
    }
    .btn:active{ transform: scale(.98); }
    #yesBtn{
      left: 25%;
      transform: translateX(-50%);
      background: var(--yes);
      color:#fff;
    }
    #yesBtn:hover{ transform: translateX(-50%) scale(1.06); filter:brightness(1.06); }
    #noBtn{
      left: 75%;
      transform: translateX(-50%);
      background: var(--no);
      color:#fff;
    }
    .hint{
      margin-top:10px;
      color:rgba(255,255,255,.95);
      font-size:.95rem;
    }
    .tiny{
      margin-top:6px;
      color:rgba(255,255,255,.85);
      font-size:.9rem;
    }

    /* Modal */
    .modalOverlay{
      position:fixed; inset:0;
      background: rgba(0,0,0,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal{
      width:min(520px, 92vw);
      background: rgba(255,255,255,.92);
      border-radius: 22px;
      padding: 18px 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,.35);
      animation: popIn .25s ease;
      text-align:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .modal h2{ margin:0 0 10px; }
    .modal p{ margin:0 0 14px; }
    .modal .mrow{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
    .mBtn{
      border:none;
      border-radius: 999px;
      padding: 10px 16px;
      font-weight:700;
      cursor:pointer;
    }
    .mYes{ background:#ff2e63; color:#fff; }
    .mNo{ background:#111; color:#fff; }
    .mOk{ background:#1f8bff; color:#fff; }

    /* Emojis */
    .emoji{
      position:fixed;
      top:-10vh;
      font-size:2.2rem;
      pointer-events:none;
      filter: drop-shadow(0 10px 12px rgba(0,0,0,.25));
      z-index:60;
    }

    /* Effects */
    .shake{ animation: shake .45s ease; }
    @keyframes shake{
      0%,100%{ transform: translateX(0); }
      20%{ transform: translateX(-10px); }
      40%{ transform: translateX(10px); }
      60%{ transform: translateX(-8px); }
      80%{ transform: translateX(8px); }
    }
    @keyframes float{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-12px); }
    }
    @keyframes popIn{
      from{ opacity:0; transform: translateY(10px) scale(.98); }
      to{ opacity:1; transform: translateY(0) scale(1); }
    }
    @keyframes pulse{
      0%,100%{ transform:scale(1); }
      50%{ transform:scale(1.04); }
    }
  </style>
</head>
<body>

  <div class="wrap">
    <h1>Veux-tu √™tre ma Valentine Cathy ? üíò</h1>

    <div class="card" id="card">
      <div class="imgBox">
        <img id="mainImg" src="debut.jpg" alt="d√©but"
          onerror="this.style.display='none'; document.getElementById('imgError').style.display='block';" />
      </div>

      <div id="imgError" style="display:none; color:white; font-size:0.95rem; padding:10px;">
        ‚ö†Ô∏è Image introuvable.<br>
        V√©rifie que √ßa s‚Äôappelle <b>debut.jpg</b> (√† la racine du repo).
      </div>

      <div class="sub">R√©ponds honn√™tement‚Ä¶ üòá</div>

      <div class="row" id="playZone">
        <button class="btn" id="yesBtn">OUI üíñ</button>
        <button class="btn" id="noBtn">NON üò≠</button>
      </div>

      <div class="hint">‚ú® Pro tip : le bouton NON est‚Ä¶ un peu timide.</div>
      <div class="tiny">Si la page est blanche/bug ‚Üí Ctrl+F5 ou navigation priv√©e.</div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modalOverlay" id="modalOverlay">
    <div class="modal" id="modal">
      <h2 id="mTitle">T‚Äôes s√ªre ? üò≥</h2>
      <p id="mText">Parce que moi je suis tr√®s s√©rieux l√†‚Ä¶ üíò</p>
      <div class="mrow" id="mRow"></div>
    </div>
  </div>

<script>
  const yesBtn = document.getElementById('yesBtn');
  const noBtn  = document.getElementById('noBtn');
  const playZone = document.getElementById('playZone');
  const card = document.getElementById('card');

  const modalOverlay = document.getElementById('modalOverlay');
  const mTitle = document.getElementById('mTitle');
  const mText  = document.getElementById('mText');
  const mRow   = document.getElementById('mRow');

  // --- Helpers
  function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

  function setNoPos(px, py){
    // px/py inside playZone
    const zone = playZone.getBoundingClientRect();
    const btn  = noBtn.getBoundingClientRect();
    const bw = btn.width, bh = btn.height;

    const x = clamp(px, 10, zone.width - bw - 10);
    const y = clamp(py, 8, zone.height - bh - 8);

    noBtn.style.left = (x + bw/2) + "px";
    noBtn.style.top  = (y) + "px";
    noBtn.style.transform = "translateX(-50%)";
  }

  function randomizeNoPosition(){
    const zone = playZone.getBoundingClientRect();
    const btn  = noBtn.getBoundingClientRect();
    const bw = btn.width, bh = btn.height;

    const x = Math.random() * (zone.width - bw - 20) + 10;
    const y = Math.random() * (zone.height - bh - 16) + 8;
    setNoPos(x, y);
  }

  function rain(emojis, count){
    for(let i=0;i<count;i++){
      const e = document.createElement('div');
      e.className = 'emoji';
      e.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      e.style.left = (Math.random()*100) + "vw";
      e.style.opacity = (Math.random()*0.5 + 0.45).toFixed(2);
      const dur = Math.random()*2200 + 2200;
      document.body.appendChild(e);

      const startX = (Math.random()*40 - 20);
      const endX = (Math.random()*140 - 70);
      e.animate([
        { transform:`translate(${startX}px,0) rotate(0deg)`, opacity: e.style.opacity },
        { transform:`translate(${endX}px,120vh) rotate(${Math.random()*360}deg)`, opacity: 0 }
      ], { duration: dur, easing: 'linear' });

      setTimeout(()=>e.remove(), dur+30);
    }
  }

  function shake(){
    card.classList.remove('shake');
    void card.offsetWidth;
    card.classList.add('shake');
  }

  // --- Make NO dodge the mouse
  // Trigger on mousemove close to the button
  playZone.addEventListener('mousemove', (ev)=>{
    const zone = playZone.getBoundingClientRect();
    const bx = ev.clientX - zone.left;
    const by = ev.clientY - zone.top;

    const nb = noBtn.getBoundingClientRect();
    const nbx = (nb.left + nb.width/2) - zone.left;
    const nby = (nb.top + nb.height/2) - zone.top;

    const dx = bx - nbx;
    const dy = by - nby;
    const dist = Math.hypot(dx, dy);

    // if mouse comes within 90px, dodge
    if(dist < 90){
      // push away from mouse
      const push = 140;
      const px = nbx - (dx / (dist || 1)) * push;
      const py = nby - (dy / (dist || 1)) * (push * 0.35);

      setNoPos(px - (noBtn.getBoundingClientRect().width/2), py - 18);
    }
  });

  // Also dodge on hover / touch
  noBtn.addEventListener('mouseenter', randomizeNoPosition);
  noBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); randomizeNoPosition(); }, {passive:false});

  // --- If she actually clicks NO: punish (fun)
  let noClicks = 0;
  noBtn.addEventListener('click', ()=>{
    noClicks++;
    shake();
    rain(["üíî","üò≠","üò°","ü´†","ü•≤","üò§"], 45);

    const lines = [
      "EH ??? üò≠",
      "T‚Äôes s√©rieuse l√† ? üíî",
      "Non non non‚Ä¶ re-choisis üò§",
      "Cathy stp‚Ä¶ j‚Äôai le c≈ìur fragile ü•∫",
      "Tu peux pas dire non √† √ßa‚Ä¶ üò≠üíî",
      "Derni√®re chance‚Ä¶ sinon je pleure fort üò≠üò≠"
    ];
    alert(lines[Math.min(noClicks-1, lines.length-1)]);

    // make it even harder next time
    randomizeNoPosition();
  });

  // --- YES hesitation flow (multi-step modal)
  const steps = [
    { title:"T‚Äôes s√ªre de √ßa ? üò≥", text:"Genre‚Ä¶ vraiment vraiment ? üíò", buttons:[["Oui j‚Äôsuis s√ªre üíñ","yes"],["Euh‚Ä¶ attends ü§≠","no"]] },
    { title:"R√©fl√©chis bien üò≠", text:"Parce que moi je dis OUI direct üòç", buttons:[["OK OUI üíò","yes"],["Je panique üòµ","no"]] },
    { title:"Derni√®re confirmation üò§", text:"Apr√®s √ßa, c‚Äôest officiel üòèüíç", buttons:[["OUIII üòçüíñ","final"],["J‚Äôai peur üò≠","no"]] }
  ];
  let stepIndex = 0;

  function openModal(step){
    modalOverlay.style.display = "flex";
    mTitle.textContent = step.title;
    mText.textContent  = step.text;
    mRow.innerHTML = "";

    step.buttons.forEach(([label, action])=>{
      const b = document.createElement('button');
      b.className = "mBtn " + (action==="no" ? "mNo" : action==="final" ? "mYes" : "mOk");
      if(action==="yes") b.className = "mBtn mOk";
      if(action==="final") b.className = "mBtn mYes";
      b.textContent = label;
      b.onclick = ()=> handleModal(action);
      mRow.appendChild(b);
    });
  }

  function closeModal(){ modalOverlay.style.display = "none"; }

  function handleModal(action){
    if(action === "no"){
      closeModal();
      shake();
      rain(["üòµ","üò≥","üôÉ","ü´£"], 25);
      alert("ü§£ vas-y‚Ä¶ clique OUI quand t‚Äôes pr√™te !");
      return;
    }
    if(action === "yes"){
      stepIndex = Math.min(stepIndex+1, steps.length-1);
      openModal(steps[stepIndex]);
      return;
    }
    if(action === "final"){
      closeModal();
      successScreen();
    }
  }

  yesBtn.addEventListener('click', ()=>{
    stepIndex = 0;
    openModal(steps[0]);
    rain(["‚ú®","üíò","üíñ"], 18);
  });

  // --- Success screen
  function successScreen(){
    document.querySelector('.wrap').innerHTML = `
      <div class="wrap">
        <h1>OUIIIII üòçüíòüíûüíñ</h1>
        <div class="card">
          <div class="imgBox">
            <img src="oui.jpg" alt="oui"
              onerror="this.style.display='none'; document.getElementById('imgError2').style.display='block';" />
          </div>
          <div id="imgError2" style="display:none; color:white; font-size:0.95rem; padding:10px;">
            ‚ö†Ô∏è Image introuvable.<br>
            V√©rifie que √ßa s‚Äôappelle <b>oui.jpg</b> (√† la racine du repo).
          </div>
          <div class="sub" style="margin-top:6px;">
            Cathy‚Ä¶ t‚Äôes ma Valentine officielle üò≠‚ù§Ô∏è
          </div>
          <div class="sub">Je t‚Äôaime fort üíñüíñüíñ</div>
          <div class="tiny" style="margin-top:10px;">(capture d‚Äô√©cran obligatoire üòå)</div>
        </div>
      </div>
    `;
    rain(["üíñ","üíò","üòç","ü•∞","‚ù§Ô∏è","üíû","üåπ","‚ú®"], 90);
    setTimeout(()=> rain(["üíñ","üíò","üòç","ü•∞","‚ù§Ô∏è","üíû","üåπ","‚ú®"], 90), 800);
  }

  // Start position for NO to avoid being stuck
  window.addEventListener('load', ()=> {
    // ensure zone measurements are correct
    randomizeNoPosition();
  });

  // Close modal when clicking outside
  modalOverlay.addEventListener('click', (e)=>{
    if(e.target === modalOverlay) closeModal();
  });
</script>

</body>
</html>
